---
title: "R Notebook - Cost model wind turbines"
output: html_notebook
---

# Initialize Data

```{r}
library(ggplot2)
library(tidyverse)
library(car)

setwd(dirname(rstudioapi::getActiveDocumentContext()$path))


cost_data<-read_delim("../data/cost_data_rinne.csv", delim=";")

names(cost_data)<-c("Source",
                    "Year",
                    "Hh",
                    "Rd",
                    "Cost",
                    "Country",
                    "Currency",
                    "Pow_dens",
                    "Rotor_area",
                    "Rated_cap")

#plot some elements

Year <- 2010:2015
Exchange_rate <- c(1.45, 1.30, 1.30, 1.33, 1.37, 1.21) 
Inflation <- c(0, 2.2, 2.8, 2.2, 0.8, 0.01)
Inflation_aggregate <- cumprod(1-Inflation/100)

ex_rate<-tibble(Year, Exchange_rate, Inflation_aggregate)

cost_data<-full_join(ex_rate,cost_data) %>% 
  mutate(Cost_conv = ifelse(Country=="United States", Cost / Exchange_rate, Cost )) %>% 
  mutate(Cost_conv = Cost_conv * Inflation_aggregate) %>% 
  na.omit()
```

# Show correlations between variables and plot them

```{r}
cost_data %>% dplyr::select(Cost_conv,Rated_cap,Rd,Hh,Year) %>% 
  cor()

cost_data %>% ggplot(aes(x=Rated_cap, y=Cost_conv)) + geom_point(aes(col=Year))

cost_data %>% ggplot(aes(x=Rd, y=Cost_conv)) + geom_point(aes(col=Year))

cost_data %>% ggplot(aes(x=Hh, y=Cost_conv)) + geom_point(aes(col=Year))

cost_data %>% ggplot(aes(x=Year, y=Cost_conv)) + geom_point(aes(col=Hh))

```

# Plot linear model with all variables

```{r}
mod1<-lm(Cost_conv~Rated_cap+Rd+Hh+Year, cost_data)
summary(mod1)
```
## So rotor length is not significant. All other variables are. Observe that rotor length and rated capacity are correlated.

```{r}
mod1.3<-lm(Cost_conv~Pow_dens+Hh+Year, cost_data)
summary(mod1.3)
```
## So power density is significant. But Rated_capacity only also is, with slightly lower model quality.

```{r}
mod1.1<-lm(Cost_conv~Rated_cap+Hh+Year, cost_data)
summary(mod1.1)

```
## We may have highly correlated input variables, which are hard to handle in such a small dataset. Using power density would be one way to do so, but it is obviously the wrong way...
```{r}
vif(mod1)
```
## Ok, Vif is not too high, but it's larger than one for all variables. What about the simpler model?
```{r}
vif(mod1.1)
```
## Well, vif goes down so multi-colinearity may be an issue. Can we specify a model that accounts for it but has no multi-colinearity?
```{r}

```




Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
